<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Variável instrumental | Econometria e Séries Temporais com R</title>
  <meta name="description" content="Este livro pode ser usado em um curso de graduação que proponha estudar econometria e séreis temporais em um nível introdutório. No entanto, também é abordado um pouco da teoria e tecnicalidade." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Variável instrumental | Econometria e Séries Temporais com R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este livro pode ser usado em um curso de graduação que proponha estudar econometria e séreis temporais em um nível introdutório. No entanto, também é abordado um pouco da teoria e tecnicalidade." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Variável instrumental | Econometria e Séries Temporais com R" />
  
  <meta name="twitter:description" content="Este livro pode ser usado em um curso de graduação que proponha estudar econometria e séreis temporais em um nível introdutório. No entanto, também é abordado um pouco da teoria e tecnicalidade." />
  

<meta name="author" content="Marcio Valk e Guilherme Pumi" />


<meta name="date" content="2020-07-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vi.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="1" data-path="vi.html"><a href="vi.html"><i class="fa fa-check"></i><b>1</b> Variáveis instrumentais</a><ul>
<li class="chapter" data-level="1.1" data-path="vi.html"><a href="vi.html#conceito-da-exogeneidade-dos-regressores"><i class="fa fa-check"></i><b>1.1</b> Conceito da exogeneidade dos regressores</a><ul>
<li class="chapter" data-level="1.1.1" data-path="vi.html"><a href="vi.html#variável-proxy"><i class="fa fa-check"></i><b>1.1.1</b> Variável proxy</a></li>
<li class="chapter" data-level="1.1.2" data-path="vi.html"><a href="vi.html#variável-omitida"><i class="fa fa-check"></i><b>1.1.2</b> Variável omitida</a></li>
<li class="chapter" data-level="1.1.3" data-path="vi.html"><a href="vi.html#erros-de-mensuração"><i class="fa fa-check"></i><b>1.1.3</b> Erros de mensuração</a></li>
<li class="chapter" data-level="1.1.4" data-path="vi.html"><a href="vi.html#variável-com-erro-de-medição"><i class="fa fa-check"></i><b>1.1.4</b> Variável com erro de medição</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variável-instrumental.html"><a href="variável-instrumental.html"><i class="fa fa-check"></i><b>2</b> Variável instrumental</a><ul>
<li class="chapter" data-level="2.0.1" data-path="variável-instrumental.html"><a href="variável-instrumental.html#diferença-entre-proxy-e-variável-instrumental"><i class="fa fa-check"></i><b>2.0.1</b> Diferença entre proxy e variável instrumental</a></li>
<li class="chapter" data-level="2.0.2" data-path="variável-instrumental.html"><a href="variável-instrumental.html#o-método-de-estimação-por-variável-instrumental"><i class="fa fa-check"></i><b>2.0.2</b> O método de estimação por variável instrumental</a></li>
<li class="chapter" data-level="2.1" data-path="variável-instrumental.html"><a href="variável-instrumental.html#inferência-com-o-estimador-por-variável-instrumental"><i class="fa fa-check"></i><b>2.1</b> Inferência com o estimador por variável instrumental</a><ul>
<li class="chapter" data-level="2.1.1" data-path="variável-instrumental.html"><a href="variável-instrumental.html#teste-de-hipóteses"><i class="fa fa-check"></i><b>2.1.1</b> Teste de hipóteses</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="variável-instrumental.html"><a href="variável-instrumental.html#variáveis-instrumentais-em-modelos-de-regressão-múltipla"><i class="fa fa-check"></i><b>2.2</b> Variáveis instrumentais em modelos de regressão múltipla</a><ul>
<li class="chapter" data-level="2.2.1" data-path="variável-instrumental.html"><a href="variável-instrumental.html#mínimos-quadrados-em-dois-estágios-mq2e"><i class="fa fa-check"></i><b>2.2.1</b> Mínimos quadrados em dois estágios (MQ2E)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometria e Séries Temporais com R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variável-instrumental" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Variável instrumental</h1>
<p>Considere o modelo
<span class="math display" id="eq:modvi">\[\begin{equation}
Y=\beta_0+\beta_1X + \varepsilon,
\tag{2.1}
\end{equation}\]</span>
em que <span class="math inline">\(\mbox{Cov}(X,\varepsilon)\neq 0\)</span>. Neste caso, os estimadores de MQO para <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> são viciados e inconsistentes e o problema é obter um estimador para estes parâmetros que apresentem propriedades melhores que o estimador de MQO. Para isso estudaremos o método de Variáveis Instrumentais.</p>
<p>Suponha que temos uma variável <span class="math inline">\(Z\)</span> satisfazendo
<span class="math display" id="eq:condvi2" id="eq:condvi1">\[\begin{align}
\mbox{Cov}(Z,\varepsilon)&amp;=0 \tag{2.2}\\
\mbox{Cov}(Z,X)&amp;\neq 0. \tag{2.3}
\end{align}\]</span>
Uma variável <span class="math inline">\(Z\)</span> satisfazendo <a href="variável-instrumental.html#eq:condvi1">(2.2)</a> e <a href="variável-instrumental.html#eq:condvi2">(2.3)</a> é chamada de , ou ainda, um  para a variável <span class="math inline">\(X\)</span>. Por razões que ficarão claras na prática, é desejável que <span class="math inline">\(|\mbox{Cor}(Z,X)|\)</span> seja a mais alta possível.</p>
<p>A condição <a href="variável-instrumental.html#eq:condvi2">(2.3)</a> é chamada de  enquanto  é chamada de .</p>
<p>Uma das maiores críticas em relação ao método de variáveis instrumentais é que a condição <a href="variável-instrumental.html#eq:condvi1">(2.2)</a> não pode ser testada diretamente, pois o erro é não-observável. Desta forma, para justificarmos a validade da condição <a href="variável-instrumental.html#eq:condvi1">(2.2)</a> precisamos recorrer à introspecção econômica e/ou argumentos filosóficos.
%É necessário uma boa “historinha” para justificar o instrumento!
A condição <a href="variável-instrumental.html#eq:condvi2">(2.3)</a>, porém, pode ser testada indiretamente via uma regressão de <span class="math inline">\(X\)</span> em <span class="math inline">\(Z\)</span> (teste de significância de qual coeficiente?) ou ainda de um teste de hipótese direto do tipo <span class="math inline">\(H_0:\mbox{Cor}(Z,X)=0 \, \, vs. \, \, H_1:\mbox{Cor}(Z,X)\neq 0\)</span></p>
<p>Infelizmente, é muito difícil encontrar instrumentos válidos para as variáveis de um determinado problema. Uma das razões dessa dificuldade reside no fato de que as duas condições requeridas de um instrumento são muitas vezes conflitantes, pois temos 3 variáveis <span class="math inline">\(X\)</span>, <span class="math inline">\(Z\)</span> e <span class="math inline">\(\varepsilon\)</span> tais que <span class="math inline">\(Z\)</span> é correlacionado com <span class="math inline">\(X\)</span> que por sua vez é correlacionado com <span class="math inline">\(\varepsilon\)</span>, mas <span class="math inline">\(Z\)</span> não pode ser correlacionado com <span class="math inline">\(\varepsilon\)</span>.</p>

<div class="example">
<p><span id="exm:logsal" class="example"><strong>Exemplo 2.1  (Estimação de equação de salário em função da educação)  </strong></span>| Variável omitida: <strong>aptidão</strong> do indivíduo - torna viesado e inconsistente o coeficiente da educação.</p>
<div class="line-block">   Possível instrumento: <strong>educação da mãe</strong> (correlacionada com a educação do indivíduo).</div>
<div class="line-block">   Mas, educação da mãe também deve ser correlacionada com a habilidade do indivíduo,</div>
<p>presente no erro? Nesse caso, não seria um bom instrumento.</p>
<div class="line-block">  <strong>Um possível instrumento seria o número de irmãos</strong> - não correlacionado com <span class="math inline">\(aptid\)</span> - correlacionado com <span class="math inline">\(educ\)</span> (negativamente).</div>
</div>

<div id="diferença-entre-proxy-e-variável-instrumental" class="section level3">
<h3><span class="header-section-number">2.0.1</span> Diferença entre proxy e variável instrumental</h3>
<p>A <span style="color: blue;"> variável proxy </span> é caracterizada por:</p>
<div class="line-block">   não ser correlacionada com o termo de erro do modelo;</div>
<div class="line-block">   correlacionada com a variável não observada.</div>
<p>A <span style="color: blue;"> variável instrumental </span> é caracterizada por</p>
<div class="line-block">   i) <em>Não ser correlacionada com o termo de erro do modelo, ou seja, não correlacionada com <span class="math inline">\(aptid\)</span> no exemplo <a href="variável-instrumental.html#exm:logsal">2.1</a></em>;</div>
<div class="line-block">   ii) <em>Correlacionada com a variável endógena, ou seja, no caso do exemplo <a href="variável-instrumental.html#exm:logsal">2.1</a>, ela deve ser correlacionada com <span class="math inline">\(educ\)</span></em>.</div>
<p>No exemplo <a href="variável-instrumental.html#exm:logsal">2.1</a> uma boa proxy seria:</p>

<p>e um bom instrumento é o <em>número de irmãos</em> (<span class="math inline">\(nir\)</span>), como visto anteriormente.</p>

</div>
<div id="o-método-de-estimação-por-variável-instrumental" class="section level3">
<h3><span class="header-section-number">2.0.2</span> O método de estimação por variável instrumental</h3>
<p>Para descrever o método de estimação por variável instrumental, considere o seguinte modelo:
<span class="math display" id="eq:vi1">\[\begin{equation}
Y=\beta_0+\beta_1 X  +\varepsilon.
\tag{2.4}
\end{equation}\]</span>
em que <span class="math inline">\(\mbox{Cov}(X,\varepsilon)\neq0\)</span> e seja <span class="math inline">\(Z\)</span> um instrumento para <span class="math inline">\(X\)</span>. Para obtermos os <em>Estimadores de Variável Instrumental</em> para <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>, começamos calculando a covariância entre <span class="math inline">\(Z\)</span> e <span class="math inline">\(Y\)</span> como segue:
<span class="math display">\[\begin{align*}
\mbox{Cov}(Z,Y)&amp;=\mbox{Cov}(Z,\beta_0+\beta_1 X  +\varepsilon)=\underbrace{\mbox{Cov}(Z,\beta_0)}_{=0}+\mbox{Cov}(Z,\beta_1 X)  +\underbrace{\mbox{Cov}(Z,\varepsilon)}_{=0}\\
&amp;=\beta_1\mbox{Cov}(Z,X)
\end{align*}\]</span>
de onde segue que
<span class="math display" id="eq:vicima">\[\begin{align}
\beta_1=\frac{\mbox{Cov}(Z,Y)}{\mbox{Cov}(Z,X)}.
\tag{2.5}
\end{align}\]</span>
Dada uma amostra de tamanho <span class="math inline">\(n\)</span> de <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> e <span class="math inline">\(Z\)</span>, obtemos o estimador de VI para <span class="math inline">\(\beta_1\)</span> substituindo-se as covariâncias que aparecem em <a href="variável-instrumental.html#eq:vicima">(2.5)</a> por suas versões amostrais, isto é,
<span class="math display">\[\hat\beta_{1VI}=\frac{\sum_{i=1}^n(z_i-\bar{z})(y_i-\bar{y})}{\sum_{i=1}^n(z_i-\bar{z})(x_i-\bar{x})} =\frac{\sum_{i=1}^nz_iy_i-n\bar{z}\bar{y}}{\sum_{i=1}^nz_ix_i-n\bar{z}\bar{x}}\,.\]</span></p>
<p>Da mesma maneira como procedemos no caso de MQO, o estimador de VI para <span class="math inline">\(\beta_0\)</span> é dado por
<span class="math display">\[ \hat{\beta}_{0VI}=\overline{Y}-\hat{\beta}_{1VI}\overline{X}.\]</span></p>
</div>
<div id="inferência-com-o-estimador-por-variável-instrumental" class="section level2">
<h2><span class="header-section-number">2.1</span> Inferência com o estimador por variável instrumental</h2>
<p>Pode-se mostrar que para <span class="math inline">\(n\)</span> grande</p>
<p><span class="math display" id="eq:bvi">\[\begin{equation}
 \hat{\beta}_{1VI} \,\,\,\, \approx \,\,\,\,\,N\,  \left(\beta_1,\frac{\sigma_\varepsilon^2}{n\sigma_X^2\rho_{XZ}^2}\right),
 \tag{2.6}
\end{equation}\]</span>
ou seja, para <span class="math inline">\(n\)</span> grande a variância do estimador é dada por</p>
<p><span class="math display" id="eq:bla">\[\begin{equation}
\mbox{Var}( \hat{\beta}_{1VI} ) =\frac{\mbox{Var}( \varepsilon )}{n \mbox{Var}(X) \mbox{Cor}(X,Z)^2 }=\frac{\sigma_\varepsilon^2}{n\sigma_X^2\rho_{XZ}^2}.
\tag{2.7}
\end{equation}\]</span>
A equação (eq:bla) nos revela algo fundamental na escolha de um bom instrumento: quanto maior a correlação entre o instrumento e a variável, menor é a variância do estimador de VI. Por esta razão, devemos procurar um instrumento que tenha a mais alta correlação possível com <span class="math inline">\(X\)</span>. Sabemos que
<span class="math display" id="eq:varvi">\[\begin{equation}
 \mbox{Var}(\hat{\beta}_{1MQO})=\frac{\sigma_\varepsilon^2}{n\sigma_X^2},
 \tag{2.8}
\end{equation}\]</span>
e desta forma obtemos que
<span class="math display">\[\mbox{Var}( \hat{\beta}_{1VI} ) =\frac{\sigma_\varepsilon^2}{n\sigma_X^2\rho_{XZ}^2} = \frac{\mbox{Var}(\hat{\beta}_{1MQO})}{\rho_{XZ}^2}\]</span>
de onde concluímos que <span class="math inline">\(\mbox{Var}( \hat{\beta}_{1VI} )\geq \mbox{Var}(\hat{\beta}_{1MQO})\)</span> com igualdade ocorrendo se, e somente se, <span class="math inline">\(|\mbox{Cor}(X,Z)|=1\)</span>. Ou seja, a menos que <span class="math inline">\(Z\)</span> seja um instrumento perfeito para <span class="math inline">\(X\)</span> (o que não ocorre na prática), o estimador de MQO sempre possui menor variância que o estimador de VI.</p>
<p>O viés assintótico de VI e MQO pode ser estudado usando os respectivos limites de probabilidade, que são:</p>
<p><span class="math display" id="eq:viesassvi">\[\begin{equation}
 \mathrm{plim}(\hat{\beta}_{1VI})=\beta_1+\frac{\mbox{Cor}(z,\varepsilon)}{\mbox{Cor}(X,Z)}\frac{\sigma_\varepsilon}{\sigma_X}
 \tag{2.9}
\end{equation}\]</span>
e
<span class="math display" id="eq:viesassvi2">\[\begin{equation}
\mathrm{plim}(\hat{\beta}_{1MQO})=\beta_1+\mbox{Cor}r(X,\varepsilon)\frac{\sigma_\varepsilon}{\sigma_X}.
\tag{2.10}
\end{equation}\]</span></p>
<div id="teste-de-hipóteses" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Teste de hipóteses</h3>
<p>Consideremos o seguinte problema</p>
<p><span class="math display" id="eq:thlogsal">\[\begin{equation}
 \log(sal\acute{a}rio)=\beta_0+\beta_1 educ+u,
 \tag{2.11}
\end{equation}\]</span>
em que <span class="math inline">\(\mbox{Cov}(educ,u)\neq 0\)</span>. Seja o , (<span class="math inline">\(nir\)</span>) um instrumento.
Queremos testar a significância de <span class="math inline">\(\hat{\beta}_{1VI}\)</span>. Os passos para esse teste são:</p>
<div class="line-block">   i) Obter <span class="math display">\[\hat{\beta}_{1VI}=\frac{\sum_{i=1}^{n}(nir_i-\overline{nir})(y_i-\overline{y})}              {\sum_{i=1}^{n}(nir_i-\overline{nir})(x_i-\overline{x})};\]</span></div>
<div class="line-block">   ii) Obter <span class="math display">\[\hat{\sigma}^2=\frac{\sum_{i=1}^{n}{\hat{u}^{2}_{i_{VI}}}}{n-2}, \]</span> em que <span class="math inline">\(\hat{u}_i^{VI}=y_i-\hat{\beta}_{0VI}-\hat{\beta}_{1VI}educ\)</span>;</div>
<div class="line-block">   iii) Obter <span class="math inline">\(R^2_{educ,nir}\)</span>, que é o <span class="math inline">\(R^2\)</span> de <span class="math display">\[educ=\alpha_0+\alpha_1nir+v;\]</span></div>
<div class="line-block">   vi) Obter a estimativa do desvio padrão</div>
<p><span class="math display">\[S(\hat{\beta}_{1VI})=\sqrt{\frac{\hat{\sigma}^2}{\sum_{i=1}^{n}(x_i-\overline{x})^2R^2_{educ,nir}}};\]</span></p>
<div class="line-block">   v) Teste:<span class="math inline">\(\begin{cases} H_0: &amp; \beta_{1VI}=0; \\ H_1: &amp; \beta_{1VI}\neq 0. \end{cases}\)</span></div>
<p>Um exemplo para ver a diferença entre as estimativas obtidas pelos dois métodos de estimação (MQO e VI), é o exemplo abaixo, reproduzido com pequenas adaptações do exemplo 15.1 do <span class="citation">Wooldridge (<a href="#ref-wooldridge2016" role="doc-biblioref">2016</a>)</span>.</p>

<div class="example">
<span id="exm:mroz" class="example"><strong>Exemplo 2.2  </strong></span>Utilizamos os dados sobre mulheres casadas que trabalham contidos no arquivo MROZ.RAW para estimar o retorno da educação no modelo de regressão simples
<span class="math display">\[Y=\beta_0+\beta_1 X+\varepsilon,\]</span>
onde <span class="math inline">\(Y\)</span> é o logaritmo do salário das mulheres casadas por hora e <span class="math inline">\(X\)</span> representa a educação. Para comparação, obtemos a reta estimada via MQO para <span class="math inline">\(Y\)</span>,
<span class="math display" id="eq:abs">\[\begin{align}
\hat Y=&amp;-0.185+0.109X\\
&amp;(0.185) \ \ (0.014)\nonumber
\tag{2.12}
\end{align}\]</span>
onde <span class="math inline">\(n=428\)</span>. Obtemos ainda <span class="math inline">\(R^2=0.118\)</span>. A estimativa de <span class="math inline">\(\beta_1\)</span> implica um retorno de perto de 11% para um ano a mais de educação. Em seguida utilizaremos a variável $Z = $ educação dos pais como variável instrumental para <span class="math inline">\(X\)</span>. Primeiramente, para determinarmos que <span class="math inline">\(\mbox{Cov}(Z,X)\neq0\)</span>, fazemos uma regressão simples de <span class="math inline">\(X\)</span> em <span class="math inline">\(Z\)</span> de onde obtemos a reta de ajustada
<span class="math display">\[\begin{align*}
\hat X=&amp;10.24+0.269Z\\
&amp;(0.28) \ \ (0.029)
\end{align*}\]</span>
com <span class="math inline">\(R^2=0.173\)</span>. A utilização de <span class="math inline">\(Z\)</span> como uma VI para <span class="math inline">\(X\)</span> produz
<span class="math display" id="eq:abs">\[\begin{align}
\hat Y=&amp;-0.441+0.059X\\
&amp;(0.446) \ \ (0.035)\nonumber
\tag{2.12}
\end{align}\]</span>
com <span class="math inline">\(R^2=0.093\)</span>. A estimativa de VI do retorno da educação é de 5.9%, que é pouco mais da metade da estimativa de MQO. Isso  que a estimativa de MQO é alta demais. Porém devemos lembrar que como as estimativas são baseadas em dados amostrais, não temos como saber qual está mais próximo do verdadeiro valor. Note ainda que o erro padrão da estimativa de VI para <span class="math inline">\(\beta_1\)</span> é duas vezes maior que a de MQO. O intervalo de confiança à 95% de <span class="math inline">\(\beta_1\)</span> utilizando MQO é muito mais estreito do que utilizando VI; de fato, o intervalo de confiança da VI contém a estimativa de MQO. Portanto, embora as diferenças entre <a href="variável-instrumental.html#eq:abs">(2.12)</a> e <a href="#eq:abs2">(<strong>??</strong>)</a> sejam grandes na prática, não podemos afirmar com certeza que as diferenças são estatísticamente significantes. O fato de o intervalo de VI conter a estimativa de MQO é uma evidência contra essa hipótese.
</div>

</div>
</div>
<div id="variáveis-instrumentais-em-modelos-de-regressão-múltipla" class="section level2">
<h2><span class="header-section-number">2.2</span> Variáveis instrumentais em modelos de regressão múltipla</h2>
<p>O estimador de VI para o modelo de regressão simples é facilmente estendido para o caso de regressão múltipla. Consideremos inicialmente o caso em que somente um dos regressores é endógeno. A equação estrutural do modelo linear padrão com duas variáveis explicativas é
<span class="math display" id="eq:VIreegMult">\[\begin{equation}
 Y_1=\beta_0+\beta_1 Y_2+\beta_2Z+\varepsilon.
 \tag{2.13}
\end{equation}\]</span>
Usamos essa notação para identificar as variáveis endógenas (<span class="math inline">\(Y\)</span>’s) e as variáveis exógenas
(<span class="math inline">\(Z\)</span>’s).
Um exemplo para <a href="variável-instrumental.html#eq:VIreegMult">(2.13)</a> é</p>
<p><span class="math display" id="eq:VIreegMult2">\[\begin{equation}
 \log(\mathrm{salario})=\beta_0+\beta_1\mathrm{educ}+\beta_2\mathrm{exper}+\varepsilon,
 \tag{2.14}
\end{equation}\]</span>
em que <span class="math inline">\(Y_1=\)</span> logaritmo do salário, <span class="math inline">\(Y_2=\)</span> educ e <span class="math inline">\(Z_1=\)</span> exper. Assim, estamos supondo que
exper é exógeno e, por razões habituais, presumimos que educ seja correlacionado com <span class="math inline">\(\varepsilon\)</span>.</p>
<p>Se estimarmos <a href="variável-instrumental.html#eq:VIreegMult">(2.13)</a> por MQO, todos os estimadores serão viesados e inconsistentes. Assim, seguimos a estratégia da seção anterior para encontrar uma VI para <span class="math inline">\(Y_2\)</span>. Como <span class="math inline">\(Z_1\)</span> aparece como variável explicativa, devemos procurar outra variável exógena (vamos chamá-la de <span class="math inline">\(Z_2\)</span>) que seja correlacionada com <span class="math inline">\(Y_2\)</span>.</p>
<p>A correlação de <span class="math inline">\(Z_2\)</span> e <span class="math inline">\(Y_2\)</span> pode ser afetada por <span class="math inline">\(Z_1\)</span> que aparece na regressão <a href="variável-instrumental.html#eq:VIreegMult">(2.13)</a>. Devemos nos certificar que na presença de <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(Y_2\)</span> e <span class="math inline">\(Z_2\)</span> ainda são correlacionados.
Essa condição pode ser verificada a partir da regressão</p>
<p><span class="math display" id="eq:fromared">\[\begin{equation}
 Y_2=\pi_0+\pi_1Z_1+\pi_2Z_2+\epsilon,
 \tag{2.15}
\end{equation}\]</span>
em que <span class="math inline">\(\mathbb{E}(\epsilon)=0\)</span>, <span class="math inline">\(\mbox{Cov}(Z_1,\epsilon)=0\)</span>, <span class="math inline">\(\mbox{Cov}(Z_2,\epsilon)=0\)</span> e os <span class="math inline">\(\pi_j\)</span> são parâmetros desconhecidos. A condição de identificação fundamental é que
<span class="math display">\[\pi_2\neq 0,\]</span> a qual pode ser testada usando-se um teste <span class="math inline">\(t\)</span>.</p>
<p><br></p>

<div class="remark">
 <span class="remark"><em>Observação. </em></span>  A equação <a href="#eq:formared">(<strong>??</strong>)</a> é um exemplo de uma ,
significando que escrevemos uma variável endógena em função de exógenas. O nome ajuda a distingui-lá da equação estrutural <a href="variável-instrumental.html#eq:VIreegMult">(2.13)</a>.
</div>

<p>A adição de mais variáveis explicativas exógenas ao modelo é direta. O modelo estrutural com <span class="math inline">\(k-1\)</span> variáveis exógenas (<span class="math inline">\(Z_1,Z_2,\ldots,Z_{k-1}\)</span>) e uma variável endógena (<span class="math inline">\(Y_2\)</span>) é</p>
<p><span class="math display" id="eq:fromaestvv">\[\begin{equation}
 Y_1=\beta_0+\beta_1Y_2+\beta_2Z_1+\beta_3Z_2+\ldots+\beta_kZ_{k-1}+\varepsilon.
  \tag{2.16}
\end{equation}\]</span>
Se <span class="math inline">\(Z_k\)</span> é uma variável exógena e queremos usá-la como uma VI para <span class="math inline">\(Y_2\)</span>, devemos
proceder de forma semelhante a <a href="#eq:formared">(<strong>??</strong>)</a>, escrevendo a equação na forma reduzida</p>
<p><span class="math display" id="eq:fromaredvv">\[\begin{equation}
 Y_2=\pi_0+\pi_1Z_1+\pi_2Z_2+\cdots+\pi_{k-1}Z_{k-1}+\pi_kZ_k+v_2,
 \tag{2.17}
\end{equation}\]</span>
para a qual é necessário que exista alguma correlação parcial entre <span class="math inline">\(Z_k\)</span> e <span class="math inline">\(Y_2\)</span>:
<span class="math display">\[\pi_k\neq 0.\]</span></p>
<div id="mínimos-quadrados-em-dois-estágios-mq2e" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Mínimos quadrados em dois estágios (MQ2E)</h3>
<p>Nesta subseção vamos mostrar a equivalência do estimador VI com MQ2E. Para isso
consideremos a equação estrutural com uma variável endógena</p>
<p><span class="math display" id="eq:mq2e1">\[\begin{equation}
Y=\beta_0+\beta_1 X  +\varepsilon,
\tag{2.18}
\end{equation}\]</span>
em que <span class="math inline">\(\mbox{Cov}(X,\varepsilon)\neq 0\)</span>. Seja <span class="math inline">\(Z\)</span> um instrumento para <span class="math inline">\(X\)</span>.</p>
<p><br></p>
<p>O procedimento MQ2E consiste em:</p>
<div class="line-block">   i) Estimar a equação reduzida <span class="math display">\[\begin{equation}    X=\alpha_0+\alpha_1 Z  +\epsilon,    (\#eq:mq2e2)   \end{equation}\]</span></div>
<p>encontrando as estimativas de <span class="math inline">\(\alpha_0\)</span> e <span class="math inline">\(\alpha_1\)</span> via MQO.</p>
<div class="line-block">   ii) Obter a reta ajustada</div>
<p><span class="math display">\[    \hat{x_i}=\hat{\alpha}_0+\hat{\alpha}_1 z_i.\]</span></p>
<div class="line-block">   iii) Estimar <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> via MQO no seguinte modelo:</div>
<p><span class="math display" id="eq:yhatx">\[\begin{equation}
 y_i=\beta_0+\beta_1 \hat{x}_i  +\eta_i,
 \tag{2.19}
\end{equation}\]</span>
para <span class="math inline">\(i=1,\ldots,n\)</span>, ou seja, usar <span class="math inline">\(\hat{X}\)</span> como uma VI para <span class="math inline">\(X\)</span>.</p>
<p>Esse procedimento resulta em uma estimativa para <span class="math inline">\(\beta_1\)</span> equivalente a <span class="math inline">\(\hat{\beta}_{1VI}\)</span>, como será demonstrado a seguir.</p>
<p>Note que:</p>
<p><span class="math display">\[\begin{eqnarray*}
   \hat{x}_i&amp;=&amp; \hat{\alpha}_0+\hat{\alpha}_1 z_i\\
            &amp;=&amp;\overline{x}-\hat{\alpha}_1\overline{z}+\hat{\alpha}_1z_i\\
	    &amp;=&amp;\overline{x}+\hat{\alpha}_1(z_i-\overline{z}).
\end{eqnarray*}\]</span>
De <a href="variável-instrumental.html#eq:yhatx">(2.19)</a>, segue que
<span class="math display">\[\begin{equation*}
 \hat{\beta_1}=\frac{\sum_{i=1}^{n}(\hat{x}_i-\overline{\hat{x}})(y_i-\overline{y})}
               {\sum_{i=1}^{n}(\hat{x}_i-\overline{\hat{x}})^2}.
\end{equation*}\]</span>
Pode-se mostrar facilmente que <span class="math inline">\(\overline{\hat{x}}=\overline{x}\)</span>. Logo,
<span class="math display">\[\begin{eqnarray*}
 \hat{\beta_1}&amp;=&amp;\frac{\sum_{i=1}^{n}\hat{\alpha}_1(z_i-\overline{z})(y_i-\overline{y})}
               {\sum_{i=1}^{n}(\hat{\alpha}_1(z_i-\overline{z}))^2}\\
	      &amp;=&amp;\hat{\alpha}_1\frac{\sum_{i=1}^{n}(z_i-\overline{z})(y_i-\overline{y})}
	       {\hat{\alpha}_1^2\sum_{i=1}^{n}(z_i-\overline{z})^2}\\
	      &amp;=&amp;\frac{\sum_{i=1}^{n}(z_i-\overline{z})(y_i-\overline{y})}
	         { \frac{\sum_{i=1}^{n}(z_i-\overline{z})(x_i-\overline{x})}{\sum_{i=1}^{n}(z_i-\overline{z})^2}\sum_{i=1}^{n}(z_i-\overline{z})^2}\\
	      &amp;=&amp;\frac{\sum_{i=1}^{n}(z_i-\overline{z})(y_i-\overline{y})}
		{\sum_{i=1}^{n}(z_i-\overline{z})(x_i-\overline{x})}\\
	      &amp;=&amp;\hat{\beta}_{1VI}.
\end{eqnarray*}\]</span></p>
<p>Quando existir mais de uma VI disponível, digamos <span class="math inline">\(Z_1,Z_2\)</span> <span class="math inline">\(Z_3\)</span>, qualquer combinação linear destas VI’s também será uma VI válida. Devemos escolher a combinação linear com a mais alta correlação com a variável endógena <span class="math inline">\(Y_2\)</span>. Isto acaba sendo fornecido pela equação na forma reduzida de <span class="math inline">\(Y_2\)</span>, que é dada por</p>
<p><span class="math display" id="eq:formaredvv123">\[\begin{equation}
 Y_2=\pi_0+\pi_1Z_1+\pi_2Z_2+\pi_3Z_3+\epsilon,
 \tag{2.20}
\end{equation}\]</span>
em que <span class="math inline">\(\mathbb{E}(\epsilon)=0,\)</span> <span class="math inline">\(\mbox{Cov}(Z_1,\epsilon)=0\)</span>, <span class="math inline">\(\mbox{Cov}(Z_2,\epsilon)=0\)</span> e <span class="math inline">\(\mbox{Cov}(Z_3,\epsilon)=0\)</span>. Portanto, a melhor VI de <span class="math inline">\(Y_2\)</span> é a combinação linear dos <span class="math inline">\(Z_j\)</span>, que denotaremos por
<span class="math display" id="eq:cly">\[\begin{equation}
   Y_2^*=\pi_0+\pi_1Z_1+\pi_2Z_2+\pi_3Z_3.
    \tag{2.21}
  \end{equation}\]</span></p>
<p>Para que esta VI não seja perfeitamente correlacionada com <span class="math inline">\(Z_1\)</span>, precisamos que
<span class="math display" id="eq:pi1oupi2">\[\begin{equation}
\pi_2\neq 0\,\,\,\mbox{ ou }\,\,\,\pi_3\neq 0.
 \tag{2.22}
\end{equation}\]</span>
Se essa hipótese de identificação, a qual pode ser testada usando-se um teste <span class="math inline">\(F\)</span>, for satisfeita, então podemos usar <span class="math inline">\(Y_2^*\)</span> como VI para <span class="math inline">\(Y_2\)</span>.</p>
<p><br></p>

<div class="remark">
 <span class="remark"><em>Observação. </em></span> Quando o problema é a existência de variáveis explicativas endógenas múltiplas, será necessária que existam pelo menos tantas variáveis exógenas excluídas do modelo quantas forem as endógenas incluídas.
</div>

<p><br></p>

<div class="remark">
 <span class="remark"><em>Observação. </em></span> Se para cada endógena existe uma única exógena, então podemos chamar o método de estimação de VI ou MQ2E.
</div>

<p><br></p>

<div class="remark">
 <span class="remark"><em>Observação. </em></span> Os testes de hipóteses múltiplas em um modelo estimado por MQ2E devem ser feitos com bastante cuidado. É possível que na estimação por VI ou MQ2E o <span class="math inline">\(R^2\)</span> seja negativo. Isso influencia diretamente a estatística <span class="math inline">\(F\)</span> e consequentemente qualquer conclusão a respeito das hipóteses.
</div>


<div id="refs" class="references">
<div>
<p>Leigh, J Paul, and Michael Schembri. 2004. “Instrumental Variables Technique: Cigarette Price Provided Better Estimate of Effects of Smoking on Sf-12.” <em>Journal of Clinical Epidemiology</em> 57 (3): 284–93.</p>
</div>
<div>
<p>Wooldridge, Jeffrey M. 2016. <em>Introductory Econometrics: A Modern Approach</em>. Nelson Education.</p>
</div>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wooldridge2016">
<p>Wooldridge, Jeffrey M. 2016. <em>Introductory Econometrics: A Modern Approach</em>. Nelson Education.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vi.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-VI.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Econometria-e-series-temporais-com-o-R.pdf", "Econometria-e-series-temporais-com-o-R.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
